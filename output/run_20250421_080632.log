[2025-04-21 08:06:35,702] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
重置第 0 层的参数...
重置权重: LayerNorm((768,), eps=1e-05, elementwise_affine=True)
重置偏置: LayerNorm((768,), eps=1e-05, elementwise_affine=True)
重置偏置: GPT2Attention(
  (c_attn): Conv1D(nf=2304, nx=768)
  (c_proj): Conv1D(nf=768, nx=768)
  (attn_dropout): Dropout(p=0.1, inplace=False)
  (resid_dropout): Dropout(p=0.1, inplace=False)
)
重置权重: Conv1D(nf=2304, nx=768)
重置偏置: Conv1D(nf=2304, nx=768)
重置权重: Conv1D(nf=768, nx=768)
重置偏置: Conv1D(nf=768, nx=768)
重置权重: LayerNorm((768,), eps=1e-05, elementwise_affine=True)
重置偏置: LayerNorm((768,), eps=1e-05, elementwise_affine=True)
重置权重: Conv1D(nf=3072, nx=768)
重置偏置: Conv1D(nf=3072, nx=768)
重置权重: Conv1D(nf=768, nx=3072)
重置偏置: Conv1D(nf=768, nx=3072)
teacher model -- Check !
student model -- Check!
There are 6 critics and optimizers
Critics -- Check!
\n--- Initial Model Precision Check ---
Command line args.dtype: torch.float16
Could not access model parameter dtype for checking: 'GPT2LMHeadModel' object has no attribute 'module'
-----------------------------------\n
Could not check critic parameter dtype: 'critic' object has no attribute 'layer_1'
Dataset -- Check!
Using a subset of the training data: 10000 samples.
Creating test set from the last 10000 samples of the 'train' split.
Start training...
CUDA_VISIBLE_DEVICES: None
Available GPUs: 1
Evaluating Student score
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
Student model Perplexity on validation set: 6135.1181640625
--- Input Data Check (Epoch 0, Step 0) ---
Input batch ('input_ids') dtype: torch.int64
------------------------------------------
/root/miniconda3/envs/distillation/lib/python3.10/site-packages/torch/autograd/graph.py:823: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:180.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
 Epoch [0/1] | Step [0/208] | Student Loss: 53.306 | C1L: -0.186, C2L: -5.755, C3L: -9.076, C4L: -10.938, C5L: -9.933, C6L: 2.707, | Kl loss: 4632.0464| Time: 1.8915
Student Perplexity on validation set: 5571.5478515625
Student model saved to ./output/distillated_student_KL/student_model_well-trained00distill_step
